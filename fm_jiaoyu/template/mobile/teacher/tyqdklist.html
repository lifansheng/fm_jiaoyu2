<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
	<title>{$bj['sname']}疫情打卡列表</title>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta name="viewport" content="width=device-width initial-scale=1.0 maximum-scale=1.0 user-scalable=yes" />
		<link type="text/css" rel="stylesheet" href="{OSSURL}public/mobile/css/bindingFormFor.css" />
		<link type="text/css" rel="stylesheet" href="{OSSURL}public/mobile/css/greenStyle.css?v=4.60120" />
		<script type="text/javascript" src="{OSSURL}public/mobile/js/jquery-1.11.3.min.js?v=4.6"></script>
		<script src="{OSSURL}public/mobile/js/jquery.js"></script>
		<script src="{OSSURL}public/mobile/js/PromptBoxUtil.js"></script>
		<link rel="stylesheet" type="text/css" href="{OSSURL}public/mobile/css/new_yab1.css?v=1?v=1111" />
		<link rel="stylesheet" type="text/css" href="{OSSURL}public/mobile/css/new_yab.css" />
		{php echo register_jssdks();}
		<style>
		*{box-sizing: border-box;}
		.click {width: auto;height: 27px;right: 0;top: 93px;background-color: #ceb750;border-radius: 50px 0 0 50px;z-index: 2; position: fixed;}
		.font_icon{width: 15px;margin-top: 6px;margin-left: 7px;margin-right: 2px;}
		.useredits{line-height: 28px;float: right;margin-right: 4px;color:#fff}

		.slide_left_menu_bg.show_menu_bg {display: block;-webkit-animation-name: fadeIn;animation-name: fadeIn;-webkit-animation-duration: 600ms;animation-duration: 600ms;-webkit-animation-fill-mode: both;/* animation-fill-mode: both; */}
		.slide_left_menu_bg {width: 100%;z-index: 998;background: rgba(0, 0, 0, 0.5);position: fixed;min-height: 100%;top: 0;left: 0;zoom: 1;overflow: hidden;display: none;height: 100%;z-index: 1000;overflow-y: scroll;}
		.slide_left_menu {width: 50%!important;right: 0;background-color: #fff;z-index: 999;min-height: 100%;position: absolute;}
		.slide_left_menu_ul li.act{border-bottom: 2px solid #30c6e1;}
		.act{border-bottom: 2px solid #30c6e1;}
		.slide_left_menu_til {height: 40px;line-height: 40px;box-sizing: border-box;padding: 0 40px 0 15px;position: relative;font-size: 16px;}
		.slide_left_menu_ul {width: 100%;border: 1px solid #ccc;border-left: none;border-right: none;box-sizing: border-box;padding: 0 10px;}
		.slide_left_menu_ul li {height: 50px;line-height: 50px;font-size: 16px;width: 100%;box-sizing: border-box;overflow: hidden;position: relative;}
		.record_search_box {
			width: 100%;
			height: 20px;
			box-sizing: border-box;
			position: relative;
			background-color: #fff;
			margin-top: 5px;
			height: 35px;
			line-height: 35px;
			font-size: 16px;
		}
		.record_search_box .time_box {
			text-align: center;
			width: 100%;
			height: 1.6rem;
			box-sizing: border-box;
			background-color: #fff;
			float: left;
			border: none;
			position: relative;
		}
		.record_search_box .time_box input {
			height: 25px;
			line-height: 25px;
			font-size: 14px;
			-webkit-appearance: none;
			border: none;
			width: 100%;
			text-align: center;
			color: #666;
		}
		.time_til_mounth {
			font-size: 0.8rem;
			line-height: 5rem;
		}
	.photos_header { width: 100%; line-height: 30px; background-color: #fff; margin-bottom: 10px; }
	.photos_header > a { display: inline-block; width: 50%; color: #30c6e1; text-align: center; height: 36px; }
	.divHeight{
		width: 100%;
		height: 10px;
		background: #f2f2f2;
	}
  .aui-head-access{
	padding: 12px 15px;
    position: relative;
    display: flex;
    -webkit-box-align: center;
    align-items: center;
    -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
    color: inherit;
	background-color: #fff;
  }
  .aui-head-access-hd{
	-webkit-box-flex: 1;
    flex: 1;
    font-size: 15px;
    color: #333333;
  }
	.aui-grids{
	position: relative;
    overflow: hidden;
    text-align: center;
	padding: 1rem 0;
	background-color: #fff;
  }

  .aui-grids-item{
	width: 25%;
    float: left;
    position: relative;
    z-index: 0;
    padding: 0.4rem 0;
    font-size: 0.85rem;
    text-align: center;
    color: #fff;
	background-color: #fff;
  }
  .aui-grids-item span{
	text-align: center;
    width: 100%;
    display: block;
    color: #323232;
    font-size: 1rem;
  }
  .aui-grids-image a span img{
	width: 40px;
    height: 40px;
    display: block;
    border: none;
    margin: 0 auto;
	border-radius: 50%;
  }
  .aui-grids-image a .aui-grids-item-text{
	color: #666666;
    font-size: 0.7rem;
    margin-top: 0.3rem;
	padding-top: 4px;
  }
		</style>
	</head>
	<body>
		{php include $this->template('port');}
		<a class="click" id="Changesf" style="top:65px">
			<img class="font_icon" src="{MODULE_URL}public/mobile/img/change_image.png"></img><div class="useredits">切换班级</div>
		</a>
		<div style="padding: 0px 10px;">
			<div class="record_search_box" style="position: relative;">
				<div class="time_box" style="position: absolute;z-index: 7;opacity: 0;">
					<input type="date" placeholder="开始时间" id="start" onchange="DateSearch()"/>
				</div>
				<div class="time_box" style="z-index: 1;" >
					<span id="dayhtml">按时间筛选</span>
				</div>
			</div>
		</div>
		<div class="photos_header" style="margin-top:10px;">
			<a class="act" id="hasdk">已打卡</a><a id='nohasdk'>未打卡</a>
		</div>
		<div class="linkDiv" style="margin-top:10px;">	
			<div id="hasdklist">
				{if !empty($hasdk)}
				<div class="aui-grids aui-grids-image">
				{loop $hasdk $item2}
					<a href="javascript:;" onclick="GotoInfo(`{$item2['id']}`)" class="aui-grids-item">
						<span>
							<img src="{$item2['icon']}">
						</span>
						<span class="aui-grids-item-text">{$item2['s_name']}</span>
					</a>
				{/loop}
				</div>
			{/if}
			</div>
			<div id="nohasdklist"  style=" display: none;">
				{if !empty($nohasdk)}
				<div class="aui-grids aui-grids-image">
				{loop $nohasdk $item2}
					<a href="javascript:;" class="aui-grids-item">
						<span>
							<img src="{$item2['icon']}" alt="">
						</span>
						<span class="aui-grids-item-text">{$item2['s_name']}</span>
					</a>
				{/loop}
				</div>
			{/if}
			</div>
		</div>
	</body>
	<div class="slide_left_menu_bg">
		<div class="slide_left_menu">
			<div class="slide_left_menu_til">班级列表</div>
			<ul class="slide_left_menu_ul">	
				{loop $allkclist $row}
					<li onclick="isSelect(`{$row['sid']}`);" {if $bj_id == $row['sid']} class="act" {/if}><div>{$row['old_sname']}</div></li>
				{/loop}					
			</ul>
		</div>
	</div>

	
{php include $this->template('newfooter');}
</html>
<script src="{OSSURL}public/mobile/js/scroll.muti.common.js?v=1718"></script>
<script type="text/javascript">
// 切换班级
$("#Changesf").on("click", function(e) {
	e.stopPropagation();
	$(".slide_left_menu_bg").addClass("show_menu_bg");
});
$(".slide_left_menu_bg").on("click", function() {
	$(this).removeClass("show_menu_bg");
});

/*打卡与未打卡切换*/
$("#hasdk").click(function () {
	$("#nohasdklist").hide();
	$("#nohasdk").removeClass('act');
	$("#hasdk").addClass('act'); 
	$("#hasdklist").show();
}); 

$("#nohasdk").click(function () {
	$("#hasdklist").hide();
    $("#hasdk").removeClass('act'); 
	$("#nohasdk").addClass('act');
	$("#nohasdklist").show();
});

// 选择班级
function isSelect(id){
	$("#hasdk").addClass('act'); 
	$("#nohasdk").removeClass('act');
    location.href = "{php echo $this->createMobileUrl('tyqdklist', array('schoolid' => $schoolid), true)}"+ '&bj_id=' + id;
}
//进入详情
function GotoInfo(id){
    location.href = "{php echo $this->createMobileUrl('tyqdkinfo', array('schoolid' => $schoolid), true)}"+ '&id=' + id;
}

function DateSearch(){
	$("#hasdk").addClass('act'); 
	$("#nohasdk").removeClass('act');
	let start = $("#start").val()
	$("#dayhtml").html(start)
	ajax_start_loading("获取数据中")
    $.post("{php echo $this->createMobileUrl('tyqdklist', array('op' => 'DateSearch', 'schoolid' => $schoolid, 'bj_id'=> $bj_id))}",{'start' : start}, function(data){
		$(".linkDiv").html(data)
		 $(window).on("scroll", scroll_fun);
		 scroll_load_obj.ajax_switch = true;
		 ajax_stop_loading()
	},'html');
}

//按时间搜索
function submitForm(){
    let start = $("#start").val()
	let end = $("#end").val()
	ajax_start_loading("获取数据中")
    $.post("{php echo $this->createMobileUrl('tyqdklist', array('op' => 'scroll_more', 'schoolid' => $schoolid, 'bj_id'=> $bj_id))}",{'start' : start, 'end' : end}, function(data){
		$(".linkDiv").html(data)
		 $(window).on("scroll", scroll_fun);
		 scroll_load_obj.ajax_switch = true;
		 ajax_stop_loading()
	},'html');	
}
// 底部加载更多
new Scroll_load({
	"limit": "0",
	"pageSize": 28,
	"ajax_switch": true,
	"ul_box": ".sick_list",
	"li_item": ".sick_list .main",
	'param' : ['time','start','end'],
	"ajax_url": "{php echo $this->createMobileUrl('tyqdklist', array('schoolid' => $schoolid ,'op'=>'scroll_more', 'bj_id' => $bj_id))}",
	"page_name": "parent_home_index",
	"after_ajax": function () {
	}
}).load_init();
</script>
