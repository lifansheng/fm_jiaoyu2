<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>{$school['title']}</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width,height=device-height,inital-scale=1.0,maximum-scale=1.0,user-scalable=no;">
<link type="text/css" rel="stylesheet" href="{OSSURL}public/mobile/css/kqtjCss.css?v=5.1"/>
<link type="text/css" rel="stylesheet" href="{OSSURL}public/mobile/css/greenStyle.css?v=4.80120" />
<link rel="stylesheet" type="text/css" href="{OSSURL}public/mobile/css/new_yab1.css?v=1?v=1111" />
<script type="text/javascript" src="{MODULE_URL}public/mobile/js/jquery-1.11.3.min.js?v=4.9"></script>
<script type="text/javascript" src="{MODULE_URL}public/mobile/js/vue.min.js"></script>
<script type="text/javascript" src="{OSSURL}public/mobile/js/jquery.reveal.js"></script>
{php include $this->template('port');}
<style>

.arrange-detail>ol {box-sizing: border-box;}
.form-order>.form-line {margin-bottom: 5px;}
.form-order>.form-line {margin-bottom: 12px;margin-top: 12px;}
.btnthis {height: 30px;background-color: #7bb52d;font: 16px "黑体";text-align: center;color: #fff;cursor: pointer;border-radius:10px}
.div_closd{margin-left:13%; width:30%;color: #fff;background-color: #f1ad31;border-color: #f1ad31;float:left;line-height:30px}
.div_sure{margin-right:13%; width:30%;float:right;line-height:30px}
.ovfHiden{overflow:hidden}
.startdate{width: 60%;margin: 3px 0px;height: 30px;line-height: 30px;border: 1px solid #e1e1e1;border-radius: 3px;font-size: 14px;background-attachment: fixed;text-align: center;padding: 0;margin: 0;outline-style: none;-webkit-tap-highlight-color: rgba(0,0,0,0);-webkit-appearance: none;}
.trhead{height:30px}
.thhead{background:white;float:left;height:40px;line-height:40px;text-align:center;font-size:16px;}
.td_mutirow{background:white;border-bottom:1px solid #EDEEF0;border-right:1px solid #EDEEF0;}
.tdsinglerow{background:white;height:30px;line-height:30px;border-bottom:1px solid #EDEEF0;}
.SelectInRange{text-align:center;text-align-last:center;width:90%;margin:8px;height:30px;border-radius: 3px;}
.reveal-modal-bg {position: fixed;height: 100%;width: 100%;background: rgba(0,0,0,0.25);z-index: 105;display: none;top: 0;left: 0; }
.reveal-modal {top:50px !important;visibility: hidden; background: #fff ;position: fixed;z-index: 101;padding: 25px 18px 38px;-moz-border-radius: 5px;-webkit-border-radius: 5px;border-radius: 5px; -moz-box-shadow: 0 0 10px rgba(0,0,0,.4);-webkit-box-shadow: 0 0 10px rgba(0,0,0,.4);-box-shadow: 0 0 10px rgba(0,0,0,.4);}
.Select-event{display: inline-block;height: 32px;border:1px solid #D7d7d7;font-size: 12px;line-height: 32px;width:72px;border-radius:4px;margin-right:8px;text-align:center}
.CheckTypes{width:25%;margin-right: 5%;}
.EVENT-SELECT{background-color: rgba(38, 123, 255, 0.2);border-color:#0885ff !important }
.CheckObj{padding:1px 3px;border-radius: 5px;font-size: 12px}
#attendance{margin-left: 3px;box-shadow:2px 2px 10px #c1c1c1;border-radius: 5px;width:98%;height:160px;padding-top:10px;float: unset}
.CheckLog{width:100%;height: 60px;border-top: 1px solid #e6e6e6;background-color: white}
.CheckMoreBtn{border:1px solid #1b90d4;border-radius: 5px;padding:1px 3px}
</style>
</head>
<body id="kqtjbody">
	<div id="attendance">
		<div @click="ChangeCondition()">
			<div style="width:100%;font-size:16px;height: 30px;line-height:30px;float: left;"> 
				<span style="float:left" >查看项目：</span> 
				<span style="display:block;float:left"> 
					<span v-if="DoneData.ErrorSch == true" class="CheckObj" style="border:1px solid #62bdf5;color:#62bdf5">异常</span> 
					<span v-if="DoneData.InAp 	== true" class="CheckObj" style="border:1px solid #20c4d6;color:#20c4d6">归寝</span> 
					<span v-if="DoneData.OutAp 	== true" class="CheckObj" style="border:1px solid #369da2;color:#369da2">离寝</span> 
			</span> 
            </div>
            <div style="width:100%;font-size:16px;height: 30px;line-height:30px;float: left;"> 
				<span style="float:left" >查看年级：</span> 
				<span style="display:block;float:left">{{DoneData.NjName}}</span> 
            </div>
            <div style="width:100%;font-size:16px;height: 30px;line-height:30px;float: left;"> 
				<span style="float:left" >查看班级：</span> 
				<span style="display:block;float:left">{{DoneData.BjName}}</span> 
			</div>
			<div style="float: left;width:100%;font-size:16px;height: 30px;line-height:30px"> 
				<span style="float:left" >时间范围：</span> 
				<span style="float:left"> {{DoneData.StartDate}} 至 {{DoneData.EndDate}} </span> 
			</div>
			<div style="float: left;width:100%;font-size:14px;height: 40px;line-height:40px;"> 
				<span  style="font-size: 12px;color:gray;float: right;padding-right: 10px">点击更改筛选条件</span>
			</div> 
		</div>

		<div class="component-dialog dialog-order reveal-modal" id="zixunkefu" style="z-index: 109;left:5vw;width:calc(90vw - 36px)" >
			<div class="component-dialog dialog-order"  id="detail_range" style="box-sizing: border-box;">
				<div class="component-dialog-title" style="margin-bottom: 10px">筛选条件</div>
				<div class="component-dialog-body">
					<div class="form-line">
						<div class="input-wrapper" style="border:none;">
							<span style="padding: 8px;float: left;color:gray">时间范围</span></br>
							<div style="width:100%;padding-top:7px;position: relative;height: 40px" >
								<span class="Select-event" style="position: absolute; top: 13px; left: 0px;width:45%" >{{StartDate}}</span>
								<span  class="Select-event" style="position: absolute; top: 13px; left: 0px;opacity: 0;width:45%" >
									<input type="date"  style="width:calc(100% - 8px);border:unset;height: 100%;margin-left: 4px;z-index: 14"  v-model="StartDate"/>      
								</span>
								<span style="position: absolute; top: 20px; left: 45%;width:10%">-</span>
								<span  class="Select-event" style="position: absolute; top: 13px; left: 55%;width:45%" >{{EndDate}}</span>
								<span  class="Select-event"  style="position: absolute; top: 13px; left: 55%;opacity: 0;width:45%"  >
									<input type="date" style="width:calc(100% - 8px);border:unset;height: 100%;margin-left: 4px;z-index: 14" v-model="EndDate" />      
								</span>
							</div>
						</div>
                    </div>
                    <div class="form-line">
						<div class="input-wrapper" style="border:none;">
							<span style="padding: 8px;float: left;color:gray">选择年级/班级</span></br>
                            <div style="width:100%;padding-top:7px;position: relative;height: 40px" >
                                <span class="Select-event" style="position: absolute; top: 13px; left: 0px;width:45%" >{{NjName}}</span>
								<select @change="ChangeNj()"  v-model="NjListKey" class="Select-event"  style="position: absolute; top: 13px; left: 0px;width:45%;opacity: 0;" >
                                    <option value="-1">不限年级</option>
                                    <option v-for="(itemnj,key) in NjList" :value="key" >{{itemnj.sname}}</option> 
                                </select>   
                                
                                <span class="Select-event" style="position: absolute; top: 13px; left: 55%;width:45%" >{{BjName}}</span>
								<select @change="ChangeBj()" id="BjSelect" v-model="BjListKey" class="Select-event"  style="position: absolute; top: 13px; left: 55%;width:45%;opacity: 0;" >
                                    <option value="-1">不限班级</option>
                                    <option v-for="itembj in BjList" :value="itembj.sid" >{{itembj.sname}}</option> 
                                </select>  

                            </div>
                        </div>
                    </div>

                    <div class="form-line">
						<div class="input-wrapper" style="border:none;">
							<span style="padding: 8px;float: left;color:gray">选择楼栋/宿舍</span></br>
                            <div style="width:100%;padding-top:7px;position: relative;height: 40px" >
                                <span class="Select-event" style="position: absolute; top: 13px; left: 0px;width:45%" >{{LdName}}</span>
								<select @change="ChangeLd()"  v-model="LdListKey" class="Select-event"  style="position: absolute; top: 13px; left: 0px;width:45%;opacity: 0;" >
                                    <option value="-1">不限楼栋</option>
                                    <option v-for="(item,key) in LdList" :value="key" >{{item.name}}</option> 
                                </select>   
                                
                                <span class="Select-event" style="position: absolute; top: 13px; left: 55%;width:45%" >{{RoomName}}</span>
								<select @change="ChangeRoom()" id="RoomSelect" v-model="RoomListKey" class="Select-event"  style="position: absolute; top: 13px; left: 55%;width:45%;opacity: 0;" >
										<option value="-1">不限宿舍</option>
                                    <option v-for="item in RoomList" :value="item.id" >{{item.name}}</option> 
                                </select>  

                            </div>
                        </div>
                    </div>

					<div class="form-line">
						<div class="input-wrapper" style="border:none;">
							<span style="padding: 8px;padding-bottom: 0px;float: left;color:gray">选择项目</span>
							<div style="width:100%;padding-top:7px;position: relative;height: 40px;text-align: left;display: flex;flex-direction: row;">
								<span class="Select-event CheckTypes" :class="InAp == true ? 'EVENT-SELECT' : '' "   @click="ChangeType('InAp')">进寝</span>
                                <span class="Select-event CheckTypes" :class="OutAp == true ? 'EVENT-SELECT' : '' "  @click="ChangeType('OutAp')">离寝</span>
                                <span class="Select-event CheckTypes" style="width:35%" :class=" ErrorSch == true ? 'EVENT-SELECT' : '' " @click="ChangeType('ErrorSch')">异常</span>
							</div>
						</div>
					</div>
					<div class="component-dialog-footer" style="margin-top: 20px">
						<div type="button" class="btn-default btnthis div_closd"  onclick="closed()" >取消</div>
						<div type="button" class="btn-primary btnthis div_sure"   data-opttype="yes" @click="ChangeDone()">确定</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<div id="main_detail"  style="margin-left: 3px;float:unset;margin-left: 1%;width:98%;background-color: white;border-radius: 8px 8px 0px 0px;overflow: hidden;">
		<div class="trhead" style="width:calc(100% - 1px);height: 40px;">
			<div class="thhead" style="width:20%;border-radius: 0px 5px 0px 0px;">学生</div>
			<div class="thhead" style="width:20%;">状态</div>
			<div class="thhead" style="width:20%;">所属班级</div>
			<div class="thhead" style="width:20%;">楼栋/宿舍</div>
			<div class="thhead" style="width:20%;border-radius: 0px 5px 0px 0px;">操作</div>
		</div>
		<div id="table_info" style="font-size: 12px">
			{loop $list $key_l $item}
			<li class="CheckLog" time="{$key_l}">
				<div class="thhead" style="width:20%;font-size: 12px;height: 60px;line-height: 20px">
					<div style="height: 40px;width:100%">
					<img src="{php echo tomedia($item['icon'])}" style="height: 37px;width:37px;border-radius: 50%;;margin-top: 2px">
					</div>
					<span>{$item['sname']}</span>
				</div>
				<div class="thhead" style="width:20%;font-size: 12px;height: 60px;line-height: 60px">
					<span>{$item['logtype']}</span> <br/>
                </div>
                <div class="thhead" style="width:20%;font-size: 12px;height: 60px;line-height: 60px">
					<span>{$item['bjname']}</span> <br/>
                </div>
                <div class="thhead" style="width:20%;font-size: 12px;height: 60px;line-height: 60px">
					<span>{$item['apatrment']}/{$item['aproom']}</span> <br/>
				</div>
				<div class="thhead" style="width:20%;font-size: 12px;height: 60px;line-height: 60px">
					<span class="CheckMoreBtn" onclick="ChaKanXiangQing(`{$item['id']}`)">查看详情</span>
				</div>
			</li>
			{/loop}
		</div>
	</div>

	<div class="component-dialog dialog-order reveal-modal" id="ChaKanXiangQing" style="z-index: 109;left:5vw;width:calc(90vw - 36px)" >
			<div class="component-dialog dialog-order"   style="box-sizing: border-box;">
				<div class="component-dialog-title" style="margin-bottom: 10px">考勤记录详情</div>
				<div class="component-dialog-body">
					<div> 学生姓名：{{StuName}}</div>
					<div> 所属年级：{{NjName}}</div>
					<div> 所属班级：{{BjName}}</div>
					<div> 所属楼栋：{{apatrment}}</div>
					<div> 所属宿舍：{{aproom}}</div>
					<div> 时&nbsp;&nbsp;&nbsp;间：{{CheckTime}}</div>
					<div> 关&nbsp;&nbsp;&nbsp;系：{{Pard}}</div>
					<div> 状&nbsp;&nbsp;&nbsp;态：{{Status}}</div>
					<div class="middleDiv"> 图&nbsp;&nbsp;&nbsp;片： 
                        <img :src="pic" class="imgdiv" style="width: 40px;height: 40px;"> 
                        <img :src="pic2" class="imgdiv" style="width: 40px;height: 40px;">
                    </div>
				</div>
			</div>
		</div>

 
	<div style="position: fixed;bottom: 70px;right: 10px;height: 50px;width: 50px;" onclick="backToTOP()">
		<img src="{MODULE_URL}public/mobile/img/backtotop_icon.png" style="height: 40px;width:40px;border-radius: 50%;">
	</div>		
    <script src="{OSSURL}public/mobile/js/scroll.muti.common.js?v=1717"></script>
    <script language="javascript">

    function backToTOP(){
        $('html,body').animate({
            'scrollTop':0
        },100)
    }

    $("body").append('<div id="common_progress" class="common_progress_bg" style=""><div class="common_progress"><div class="common_loading"></div><br><span>正在载入...</span></div></div>');

    function ajax_start_loading(text) {
        $("#common_progress").css("display", "block");
        $("body").css("position", "fixed");
        $(".common_progress").css("margin-left", $(window).width() / 2 - 80);
        if (text) {
            $("#common_progress span").text(text);
        }
    }
    // 关闭菊花转
    function ajax_stop_loading() {
        $("#common_progress").hide();
        $("body").css("position", "static");
    }


    var scroll_load_obj = null;

    function scroll_fun() {
        var winHeight = window.innerHeight || document.documentElement.clientHeight,
            scrollTop = document.body.scrollTop || document.documentElement.scrollTop,
            documentHeight = $(document).height();
        if (parseInt(winHeight) + parseInt(scrollTop) + 5 > parseInt(documentHeight)) {
            var self = scroll_load_obj;
            $(window).off("scroll", scroll_fun);
            if (self.ajax_switch) {
                self.ajax_switch = false; 
                var datanumb = $(self.ul_box).children('li').length;
                if(datanumb >= 1){
                    $('.has_show_over').show();
                    $('.has_show_over').animate({height:"45px"});
                    $(".jzz").removeClass('jzz_over');
                    $('.jzz_text').text('加载中');
                }
                var search_type='';
                var search_content='';
                if($('#search_input').length>0){
                    typesearch_content = $.trim($('#search_input').val());
                    $('.type_item.checked').each(function () {
                        if (search_type != '') {
                            search_type += ',' + $(this).attr('type');
                        } else {
                            search_type += $(this).attr('type');
                        }
                    })
                }
                if (index_type_item != '') {
                    search_type = index_type_item;
                }

                var GetLiData = {};
                for(let item of self.param){
                    GetLiData[item] = $(self.ul_box).children(`${self.li_item}`).eq($(self.ul_box).children(`${self.li_item}`).length-1).attr(`${item}`) || -1 ;
                }
            
                var post_data = { 
                    limit: $(self.ul_box).children('li').eq($(self.ul_box).children('li').length-1).attr('time'),
                    noticeytpe: $("#noticeytpe").val(),
                    LiData : GetLiData,
                    limit_org:self.limit_org,
                    content: search_content,
                    //这个地方将一些其他参数加上去
                    StartDate: TopVue.DoneData.StartDate,
                    EndDate  : TopVue.DoneData.EndDate,
                    InAp    : TopVue.DoneData.InAp,
                    OutAp   : TopVue.DoneData.OutAp,
                    ErrorSch: TopVue.DoneData.ErrorSch,
                    NjId    : TopVue.DoneData.NjId,
                    BjId    : TopVue.DoneData.BjId,
                    LdId    : TopVue.DoneData.LdId,
                    RoomId    : TopVue.DoneData.RoomId,
                };
                $('.has_show_over').show();
                $.ajax({
                    type: 'POST',
                    url: self.ajax_url,
                    data: post_data,
                    dataType: "html",
                    success: function (data) {
                        //载入更多内容
                        if ($.trim(data)) {
                            $(self.ul_box).append(data);
                            if (typeof (self.after_ajax) != 'undefined') {
                                self.after_ajax();
                            }
                            $(window).on("scroll", scroll_fun);
                            self.ajax_switch = true;
                        } else {
                            $('.has_show_over').show();
                            $('.jzz_text').text('数据已加载完毕');
                            $(".jzz").addClass('jzz_over');
                            $(window).off("scroll", scroll_fun);
                            $('.has_show_over').animate({height:"0"});

                        }
                    },
                    error: function () {
                        jTips('加载失败！');
                        $(window).on("scroll", scroll_fun);
                        self.ajax_switch = true;
                    }
                }) //ajax结束
            }
        }
    }

    var TopVue = new Vue({
        el: '#attendance' ,
        data: function () {
            return{
                InAp     : true,
                OutAp    : true,
                ErrorSch : true,
                NjName   : "{$NjN}",
                BjName   : "{$BjN}",
                NjListKey: {$NjKey},
                BjListKey: {$BjId},
                BjList	 :[],
                StartDate: '{php echo date("Y-m-d",$starttime)}',
                EndDate  : '{php echo date("Y-m-d",$endtime)}',
                DoneData : {
                    InAp     : true,
                    OutAp    : true,
                    ErrorSch : true,
                    StartDate: '{php echo date("Y-m-d",$starttime)}',
                    EndDate  : '{php echo date("Y-m-d",$endtime)}',
                    NjName   : "{$NjN}",
                    BjName   : "{$BjN}",
                    NjListKey: {$NjKey},
                    BjListKey: {$BjId},
                    NjId     : {$NjId},
                    BjId     : {$BjId},
                    LdId     : -1,
                    RoomId   : -1,
                    LdListKey: -1,
                    RoomListKey: -1,
                    LdName   : '不限楼栋',
                    RoomName : '不限宿舍',
                },
                NjList  :[],
                LdListKey: -1,
                RoomListKey: -1,
                RoomList  :[],
                LdList  :[],
                LdName   : "不限楼栋",
                RoomName   : "不限宿舍",
                LdId : -1,
                RoomId : -1,
                NjId : -1,
                BjId : -1,
            }
        },
        methods:{
            ChangeNj:function(){
                if(this.NjListKey != -1){
                    this.BjList = this.NjList[this.NjListKey]['bjlist']
                    this.NjId = this.NjList[this.NjListKey]['sid']
                    this.NjName = this.NjList[this.NjListKey]['sname']
                    this.BjListKey = this.BjList[0]['sid'];
                    this.BjId = this.BjList[0]['sid'];
                    this.BjName = this.BjList[0]['sname'];
                }else{
                    this.BjList = [];
                    this.NjName = "不限年级"	
                    this.BjId = -1
                    this.NjId = -1
                    this.BjListKey = -1;
                    this.BjName = "不限班级";
                }
            },
            ChangeBj:function(){
                if(this.BjListKey != -1){
                    this.BjName = $("#BjSelect option:selected").text();
                    this.BjId = $("#BjSelect option:selected").val();
                }else{
                    this.BjName = "不限班级"
                    this.BjId = -1;
                }
            },
            ChangeCondition:function(){
                this.InAp      = this.DoneData.InAp
                this.OutAp     = this.DoneData.OutAp
                this.StartDate = this.DoneData.StartDate
                this.EndDate   = this.DoneData.EndDate
                this.NjListKey = this.DoneData.NjListKey
                this.BjListKey = this.DoneData.BjListKey
                this.NjName    = this.DoneData.NjName
                this.BjName    = this.DoneData.BjName
                this.ErrorSch  = this.DoneData.ErrorSch  
                this.LdListKey = this.DoneData.LdListKey
                this.RoomListKey = this.DoneData.RoomListKey  
                this.LdName = this.DoneData.LdName  
                this.RoomName = this.DoneData.RoomName 
                this.LdId = this.DoneData.LdId  
                this.RoomId = this.DoneData.RoomId 
                this.NjId = this.DoneData.NjId  
                this.BjId = this.DoneData.BjId 
                $('#zixunkefu').reveal();
            },
            ChangeType:function(e){
                TopVue[e] = !TopVue[e]
            },
            ChangeDone:function(){
                let self = this;
                self.DoneData.InAp      = self.InAp
                self.DoneData.OutAp     = self.OutAp
                self.DoneData.ErrorSch  = self.ErrorSch
                self.DoneData.StartDate = self.StartDate
                self.DoneData.EndDate   = self.EndDate;
                self.DoneData.NjId      = self.NjId
                self.DoneData.BjId      = self.BjId
                self.DoneData.NjName    = self.NjName
                self.DoneData.BjName    = self.BjName
                self.DoneData.LdId      = self.LdId
                self.DoneData.RoomId    = self.RoomId
                self.DoneData.LdName    = self.LdName
                self.DoneData.RoomName  = self.RoomName
                ajax_start_loading("获取数据中");
                $('#zixunkefu').trigger('reveal:close');
                $.ajax({
                    url: "{php echo $this->createMobileUrl('tapcheck', array('schoolid' => $schoolid,'op'=>'More_Data' ), true)}",
                    data : self.DoneData,	
                    dataType: 'html',
                    type: "post",
                    success: function (data) {
                        $("#table_info").html(data);
                        scroll_load_obj.ajax_switch = true;
                        $(window).on("scroll", scroll_fun);
                        ajax_stop_loading();
                    }
                });	
            },
            ChangeLd:function(){
                if(this.LdListKey != -1){
                    this.RoomList = this.LdList[this.LdListKey]['roomlist']
                    this.LdId = this.LdList[this.LdListKey]['id']
                    this.LdName = this.LdList[this.LdListKey]['name']
                    if(this.RoomList == "" || this.RoomList == null || this.RoomList == undefined){
                        this.RoomListKey = -1;
                        this.RoomId = -1;
                        this.RoomName = "不限宿舍";
                    }else{
                        this.RoomListKey = this.RoomList[0]['id'];
                        this.RoomId = this.RoomList[0]['id'];
                        this.RoomName = this.RoomList[0]['name'];
                    }
                }else{
                    this.RoomList = [];
                    this.LdName = "不限楼栋"	
                    this.LdId = -1
                    this.RoomId = -1
                    this.RoomListKey = -1;
                    this.RoomName = "不限宿舍";
                }
                
            },
            ChangeRoom:function(){
                if(this.RoomListKey != -1){
                    this.RoomName = $("#RoomSelect option:selected").text();
                    this.RoomId = $("#RoomSelect option:selected").val();
                }else{
                    this.RoomName = "不限楼栋"
                    this.RoomId = -1;
                }
            },
        },
        created:function(){
            let self = this;
            //获取年级班级列表
            $.ajax({
                url: "{php echo $this->createMobileUrl('tapcheck', array('schoolid' => $schoolid,'op'=>'GetNjListData' ), true)}",	
                dataType: 'json',
                type: "post",
                success: function (data) {
                    self.NjList = data
                    self.BjList = data[0]['bjlist'] ? data[0]['bjlist'] : [];
                }
            });	
            //获取楼栋宿舍信息
            $.ajax({
                url: "{php echo $this->createMobileUrl('tapcheck', array('schoolid' => $schoolid,'op'=>'GetRoomListData' ), true)}",	
                dataType: 'json',
                type: "post",
                success: function (data) {
                    self.LdList = data
                    self.RoomList = data[0]['roomlist'] ? data[0]['roomlist'] : [];
                }
            });	

        },
    })

    var DetailVue = new Vue({
        el:"#ChaKanXiangQing",
        data:function(){
            return{
                StuName:'',
                CheckTime:'',
                Status : '',
                Pard:'',
                BjName : "",
                NjName : "",
                apatrment : "",
                aproom : "",
                pic : "",
                pic2 : "",
            }
        }
    })



    function ChaKanXiangQing(id){
            let self = DetailVue;
            $.ajax({
                url: "{php echo $this->createMobileUrl('tapcheck', array('schoolid' => $schoolid,'op'=>'GetDetail' ), true)}",
                data : {
                    id :id
                },	
                dataType: 'json',
                type: "post",
                success: function (data) {
                    self.StuName = data.data.sname;
                    self.BjName = data.data.bjname;
                    self.NjName = data.data.njname;
                    self.CheckTime = data.data.checkTime;
                    self.Status = data.data.status;
                    self.Pard = data.data.pard;
                    self.apatrment = data.data.apatrment;
                    self.aproom = data.data.aproom;
                    self.pic = data.data.pic;
                    self.pic2 = data.data.pic2;
                    srcList = [data.data.pic,data.data.pic2];
                }
            });	
            $("#ChaKanXiangQing").reveal();
           
        }
    
        


    function closed(){
        $('#zixunkefu').trigger('reveal:close');
        
    };
    

    new Scroll_load({
        "limit": "0",
        "ajax_switch": true,
        "ul_box": "#table_info",
        "li_item": ".CheckLog",
        "param": ["time"],
        "ajax_url": "{php echo $this->createMobileUrl('tapcheck', array('schoolid' => $schoolid,'op'=>'More_Data' ), true)}",
        "page_name": "teacher_notify",
        "after_ajax": function () {
        }
    }).load_init();



    var WeixinApi = (function () {
        return {
            imagePreview: imagePreview
        };
        "use strict";
        /**
            * 调起微信Native的图片播放组件。
            * 这里必须对参数进行强检测，如果参数不合法，直接会导致微信客户端crash
            *
            * @param {String} curSrc 当前播放的图片地址
            * @param {Array} srcList 图片地址列表
            */
        function imagePreview(curSrc, srcList) {
            if (!curSrc || !srcList || srcList.length == 0) {
                return;
            }
            WeixinJSBridge.invoke('imagePreview', {
                'current': curSrc,
                'urls': srcList
            });
        }
        return {
            version: "2.5",
            ready: wxJsBridgeReady,
            imagePreview: imagePreview
        };
    })();

    function wxImageShow(src) {
        WeixinApi.imagePreview(src, srcList);
    }
    $(function () {
        $(".imgdiv").on('click',function(){
            let src = $(this).attr("src");
            wxImageShow($(this).attr("src"))
        })
    });  
</script>	
{php include $this->template('newfooter');}
</body>
</html>