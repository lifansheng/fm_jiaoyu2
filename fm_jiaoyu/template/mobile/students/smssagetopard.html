<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
	<meta name="format-detection" content="telephone=no">
	<meta name="HandheldFriendly" content="true" />
	<script type="text/javascript" src="{OSSURL}public/mobile/js/hb.js?v=1124"></script>
	<link href="{OSSURL}public/mobile/css/new_yab.css?v=112420161108" rel="stylesheet" />
	<script type="text/javascript" src="{MODULE_URL}public/mobile/js/jquery-1.11.3.min.js?v=4.8"></script>
	<link href="{$_W['siteroot']}web/resource/css/font-awesome.min.css" rel="stylesheet">
	<script type="text/javascript" src="{OSSURL}public/mobile/js/PromptBoxUtil.js?v=4.81022"></script>
	{php echo register_jssdks();}
	{php include $this->template('port');}
	<style>
		.ovfHideen{height:calc(100vh - 50px);overflow: hidden;}
		body {font-family: initial;}
		.mainColor{background:#06c1ae !important;}
		.vacationRecord_section {display: block;margin: 10px;width: auto;background-color: white;border-radius: 10px;position: relative;padding-top: 10px;padding-bottom: 10px;}
		.vacationItem {position: relative;padding: 0px 0 0 15px;margin: 0px 0 0px 20px;height: 32px;display: -webkit-box;display: -moz-box;display: -ms-flexbox; display: -webkit-flex; display: flex;
		-webkit-box-align: center;-moz-box-align: center;-ms-flex-align: center;-webkit-align-items: center;align-items: center;border-left: 1px solid #06c1ae;}
		.vacationItem:first-child {margin: 5px 0 0px 20px;}
		.vacationItem:last-child {margin-bottom: 2px;}
		.vacation_title {font-size: 14px;color: rgb(34, 34, 34);}
		.vacation_mom {font-size: 14px;color: #06c1ae;}
		.vacation_left {padding-left: 3px;}
		.vacation_time {font-size: 12px;color: rgb(102, 102, 102);}
		.left_dotsVacation {position: absolute;width: 10px;height: 10px;background-color: #06c1ae;border-radius: 50%;left: -5px;top: 50%;transform: translateY(-50%);-webkit-transform: translateY(-50%);-moz-transform: translateY(-50%);-ms-transform: translateY(-50%);-o-transform: translateY(-50%);}
		/*老师回复*/
		.teachReplyBox {margin: 10px 0 0px 35px;position: relative;}
		.teachReplyInfo {width: 6rem;height: auto;display: block;background-color: rgb(248, 248, 248);border: 1px solid rgb(238, 238, 238);border-radius: 5px;margin-bottom: 5px;position: relative;margin-top: .36rem;}
		.teachReplyInfo::after {content: "";display: block;height: 0;clear: both;visibility: hidden;}
		.teachReplyLeftBox {width: 0.7rem;height: 0.7rem;border-radius: 50%;display: inline-block;float: left;}
		.teachReplyRightBox {display: inline-block;height: 100%;float: left;width: 95%;}
		.teachReplyRightTitle {display: inline-block;height: 35px;padding-left: 5px;}
		.teachReplyRightDescribe {display: inline-block;margin-top: 0.3rem;margin-bottom: 0.3rem;margin-left: 0.3rem;}
		.teachReplyName {font-size: 14px;color: rgb(102, 102, 102);display: block;margin-top: 2px;}
		.teachReplyTitle_Time {font-size: 12px;color: rgb(153, 153, 153);}
		.teachReplyRightDescribeInfo {font-size: 14px;}
		.teachReplyBottom {padding-bottom: 10px;height: auto;}
		/*三角形*/
		.teachReplyInfo em, .teachReplyInfo .teachTop {display: block;width: 30px;height: 16px;font-size: 30px;overflow: hidden;_position: relative;margin-left: 0px;}
		.teachReplyInfo em {margin-top: -16px;color: rgb(238, 238, 238);font-style: normal;}
		.teachReplyInfo .teachTop {margin-top: -14px;color: rgb(248, 248, 248);position: absolute;}
		/*左边线条*/
		.teachReplyLeftLine {position: absolute;left: -15px;top: -34px;height: 32px;}
		/*左边圆*/
		.teachReplyLeftCircle {position: absolute;width: 10px;height: 10px;border-left: 1px solid #06c1ae;left: -20px;top: 8px;border-radius: 50%;background-color: #06c1ae;}
		/*右边提示*/
		.statusTip {position: absolute;width: 40px;height: 42px;right: 0;top: 0;}
		.statusTipTop {width: 100%;height: 22px;font-size: 12px;color: white;background-color: rgb(255, 102, 101);line-height: 22px;text-align: center;border-bottom: 1px solid rgb(255, 131, 130);}
		.tip_approve_down {width: 0;height: 0;border-left: 20px solid transparent;border-right: 20px solid transparent;border-top: 20px solid rgb(255, 102, 101);}
		/*不批准提示*/
		.statusTipTop_disapprove {background-color: rgb(153, 153, 153);text-align: center;border-bottom: 1px solid rgb(172, 172, 172);}
		.tip_approve_down__disapprove {border-top: 20px solid rgb(153, 153, 153);}
		.otherTime {color: rgb(153, 153, 153);}
		.vacationRecord_section:first-child {margin-top: 10px;}
		.signin_leftBox {position: absolute;}
		.refuse, .approve {width: 75px;height: 30px;color: white;text-align: center;line-height: 30px;font-size: 14px;border-radius: 25px;position: absolute;cursor: pointer;}
		.refuse {background-color: #ff9f22;left: 1rem;}
		.approve {background-color: #06c1ae;right: 1rem;}
		.vacationItem > a {width: 75px;height: 30px;color: white;}
		.vacation_titleOther {max-width: 80%;padding-left: 3px;line-height: 18px;}
		.vacationItemOther {height: auto;-webkit-box-align: flex-start;-moz-box-align: flex-start;-ms-flex-align: flex-start;-webkit-align-items: flex-start;align-items: flex-start;padding-bottom: 5px;padding-top: 5px;}
		.left_dotsVacationOther {top: 12px;}
		.teachReplyTitleBox {padding-top: 5px;position: relative;}
		.lectBorderLine {position: absolute;border-left: 1px solid #06c1ae;left: -15px;top: 0px;height: 16px;}
		.header { width: 100%; height: 50px; line-height: 50px; position: fixed; z-index: 1000; top: 0; left: 0; box-shadow: 0 0 2px 0px rgba(0,0,0,0.3),0 0 6px 2px rgba(0,0,0,0.15); }
		.header .l { width: 50px; height: 50px; line-height: 50px; color: white; position: absolute; left: 0; top: 0; }
		.header .m { width: 100%; height: 50px; line-height: 50px; text-align: center; color: white; font-size: 18px; }
		.header .r { width: 50px; height: 50px; line-height: 50px; position: absolute; right: 0; top: 0; }
		.mainColor { background: #06c1ae !important; }
		.header .l a { font-size: 18px; color: white; display: block; width: 100%; height: 100%; text-align: center; }
		.header .m a i {float: left;margin: 23px 0 0 5px;width: 0;height: 0;border-width: 6px 6px 0;border-style: solid;border-color: white transparent transparent;position: absolute;}
		.img-responsive {display: block;width: 35px;border-radius: 50%;height: 35px;}
		.selectList {position: fixed;left: 0;right: 0;top: 0;bottom: 0;-webkit-box-sizing: border-box;box-sizing: border-box;background-color: rgba(0,0,0,.53);text-align: center;z-index: 30;font-size: 20px;    color: #fe6700;}
		.selectList .single {position: absolute;left: 6%;right: 6%;top: 15%;padding: 0 20px;background-color: #fff;padding-bottom: 33px;padding-top: 10px;height: 62vh; }
		.selectList ul {width: 100%;height: auto;overflow: auto;}
		.selectList ul li {height: 50px;line-height: 50px;border-bottom: 1px solid #e9e9e9;padding: 0 10px;}
		.selectList ul li span.ri {height: 50px;line-height: 50px;font-size: 16px;}
		/* 详细病因弹出框 */
		.BackGroundPoP{width:100vw;height: 100vh;background-color: rgba(154,154,154,0.6);top: 0px;position: fixed;z-index: 9999;overflow: hidden;}
		.BackGroundPoP *{box-sizing: border-box;}
		.TopLeft{padding-top:8px;padding-left: 10px;font-size: 25px;float: left;}
		.TopMiddle{font-size: 16px;text-align: center; line-height: 40px;padding-right: 40px;}
		.BingYinDetail{height: 80vh;width: 100vw;background-color: rgb(249, 249, 249);margin-top: -90vh;}
		.TopInfo{height: 40px;width: 100vw;text-align: center;border-bottom: 1px solid #b7b7b7;background-color: white;}
		.BYBox{width:100%;box-sizing: border-box;overflow: scroll;height: calc(80vh - 40px);padding-top: 10px;}
		.BYBox_level{width: 100%;background-color: white;margin-bottom: 20px;padding:0 10px;box-sizing: border-box;border-top:1px solid rgb(240, 240, 240);border-bottom:1px solid rgb(240, 240, 240)}
		.BoxCell{height: 35px;width: 100%;border-bottom: 0.5px solid #f1f1f1;font-size: 15px;box-sizing: border-box;}
		.Heihly{height: auto !important;}
		.BoxCell .left{float: left;height: 100%;width: 90px;text-align: right; line-height: 35px;}
		.BoxCell .right{float: left;height: 100%;width: calc(100% - 90px);text-align: right; line-height: 35px;}
		.BoxCell .right input{border: unset; width: 100%; height: 34px;}
		.BoxCell .rightTips {float: left;height: 100%;width: calc(100% - 90px);text-align: right; line-height: 35px;font-size: 12px;color:gray}
		input::-webkit-input-placeholder, textarea::-webkit-input-placeholder { color: rgb(177, 175, 175); font-size: 14px; }
		.UpBtn{padding:5px 5px;height: 30px; font-size: 14px;border-radius: 5px;color: white;}
		.btnGroupBox{width: 100%;height: 40px;display: flex;flex-direction: row;justify-content: space-between;padding:0 10px;box-sizing: border-box;}

		/* 治愈情况详情 */
		.HealDetail{height: 100vh;width: 100vw;background-color: rgb(249, 249, 249);margin-left: 100vh;}
		.consult_audio {
			float: right;
			font-size: 16px;
			color: #fff;
			background: #06c1ae;
			border-radius: 5px;
			padding: 6px;
			margin-left: 5px;
			position: relative;
			word-break: break-all;
			word-wrap: break-word;
			height: 20px;
		}
		.consult_audio .arrow {
			width: 8px;
			height: 9px;
			position: absolute;
			background: url("{MODULE_URL}public/mobile/img/arrow_right.png") no-repeat;
			background-size: 8px;
			right: -8px;
			margin-top: -1px;
		}
		.consult_audio .div_voice {
			height: 100%;
			width: 40px;
			padding-right: 5px;
		}
		.consult_audio .div_voice .icon {
			height: 100%;
			background: url("{MODULE_URL}public/mobile/img/voice_icon.png") no-repeat; 
			background-size: 18px;
		}
	</style>
	<title>{$school['title']}</title>
</head>
<body  >
	<div class="header mainColor">
		<div class="m">
			<a id="showbjlist">
				<span style="font-size: 18px">请假列表</span>
			</a>
		</div>
		
	</div>
	<div class="All ">
		<div class="list">
			<div class="listContent" style="margin-top: 15px">
				<div class="leave" style="padding: 0">
				{loop $leave $row}
					<div class="vacationRecord_section">
						<div class="vacationItem">
							<span class="vacation_title">申请人:</span><span class="vacation_mom vacation_left">{$row['s_name']}{$row['guanxi']}</span>
							{if $row['isshowopera'] && $row['pardstatus'] == 0 }
							<span style="color: red;">(待家长同意)</span>
							{else if $row['status'] == 0}
							<span style="color: red;">(待老师审批)</span>
							{/if}
							<div class="left_dotsVacation"></div>
						</div>
						<div class="vacationItem">
							<span class="vacation_time">开始时间:</span><span class="vacation_time vacation_left">{if $row['startime']}{$row['startime']}{else}{php echo date('Y-m-d H:i:s',$row['startime1'])}{/if}</span>
							<div class="left_dotsVacation"></div>
						</div>
						<div class="vacationItem">
							<span class="vacation_time">结束时间:</span><span class="vacation_time vacation_left">{if $row['endtime']}{$row['endtime']}{else}{php echo date('Y-m-d H:i:s',$row['endtime1'])}{/if}</span>
							<div class="left_dotsVacation"></div>
						</div>
						<div class="vacationItem">
							<span class="vacation_title">类型:</span><span class="vacation_title vacation_left">{$row['type']}</span>
						</div>
						<div class="vacationItem vacationItemOther">
							<span class="vacation_title">原因:</span><span class="vacation_title vacation_titleOther">{$row['conet']}</span>
							<div class="left_dotsVacation left_dotsVacationOther"></div>
						</div>
						
						<div class="teachReplyBottom">
							<span class="vacation_time otherTime">申请时间:</span><span class="vacation_time vacation_left otherTime">{php echo date('Y-m-d H:i:s',$row['createtime'])}</span>
						</div>
						<div class="left_teachReply"></div>
						<div class="teachReplyLeftLine"></div>
						<div class="teachReplyLeftCircle"></div>

						{if $row['status'] == 0 || $row['pardstatus'] == 0 }
						<div class="statusTip">
							<div class="statusTipTop statusTipTop_disapprove">待批</div>
							<div class="tip_approve_down tip_approve_down__disapprove"></div>
						</div>
						{else if $row['status'] == 2}
						<div class="statusTip">
							<div class="statusTipTop statusTipTop_disapprove">拒绝</div>
							<div class="tip_approve_down tip_approve_down__disapprove"></div>
						</div>
						{else if $row['status'] == 1}
						<div class="statusTip">
							<div class="statusTipTop">批准</div>
							<div class="tip_approve_down"></div>
						</div>
						{/if}
						<div class="signin_leftBox"></div>
						{if $row['pardstatus'] == 0 && !$row['isshowopera']}
						<div class="vacationItem vacationItemBtn">
							<a href="javascript:;" class="refuse">
								<div class="btn_refuse" onclick="tijiao(`{$row['id']}`,2)">拒绝</div>
							</a>
							<a href="javascript:;" class="approve">
								<div class="btn_approve" onclick="tijiao(`{$row['id']}`,1)">同意</div>
							</a>
						</div>
						{/if}
					</div>
				{/loop}
				</div>
			</div>
		</div>
	</div>
<script>
function tijiao(leaveid,status){
	let submitdata = {
		schoolid : "{$schoolid}",
		weid : "{$weid}",
		leaveid : leaveid,
		sid : `{$it['sid']}`,
		status : status,
	}
	jConfirm("确认当前操作吗?", "确定对话框", function (isConfirm) {
		if(isConfirm){
			ajax_start_loading("提交中...");
			$.ajax({
				type: "POST",
				dataType: 'json',
				url: "{php echo $this->createMobileUrl('indexajax',array('op'=>'pardOpera'))}",
				data: submitdata,
				success: function(result) {
					ajax_stop_loading();
					alert(result.msg)
					location.reload()
				},
			});
		}
	});	
}

	
</script>
{php include $this->template('newfooter');}